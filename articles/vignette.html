<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>scGPS introduction â€¢ scGPS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="scGPS introduction">
<meta property="og:description" content="scGPS is a single cell RNA analysis framework to decompose a mixed population into clusters (SCORE), followed by analysing the relationship between clusters (scGPS)">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scGPS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette.html">scGPS introduction</a>
    </li>
  </ul>
</li>


<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Benchmarking
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../benchmarking/benchMarking_baron.html" target="_blank">Baron Cluster</a>
      <a href="../benchmarking/benchMarking_camp.html" target="_blank">Camp Cluster</a>
      <a href="../benchmarking/benchMarking_klein.html" target="_blank">Klein Cluster</a>
      <a href="../benchmarking/benchMarking_koh.html" target="_blank">Koh Cluster</a>
      <a href="../benchmarking/benchMarking_kumar.html" target="_blank">Kumar Cluster</a>
      <a href="../benchmarking/benchMarking_yan.html" target="_blank">Yan Cluster</a>
      <a href="../benchmarking/buettner.html" target="_blank">Buettner Trajectory</a>
      <a href="../benchmarking/engel.html" target="_blank">Engel Trajectory</a>
      <a href="../benchmarking/guo.html" target="_blank">Guo Trajectory</a>
      <a href="../benchmarking/hayashi.html" target="_blank">Hayashi Trajectory</a>
      <a href="../benchmarking/kowalczyk.html" target="_blank">Kowalczyk Trajectory</a>
      <a href="../benchmarking/loh.html" target="_blank">Loh Trajectory</a>
      <a href="../benchmarking/petropoulos.html" target="_blank">Petropoulos Trajectory</a>
      <a href="../benchmarking/saliba.html" target="_blank">Saliba Trajectory</a>
      <a href="../benchmarking/schlitzer.html" target="_blank">Schlitzer Trajectory</a>
      <a href="../benchmarking/trapnell.html" target="_blank">Trapnell Trajectory</a>
      <a href="../benchmarking/zhang.html" target="_blank">Zhang Trajectory</a>
    </li>
  </ul>
</li>

      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/IMB-Computational-Genomics-Lab/scGPS/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vignette_files/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="vignette_files/d3-4.5.0/d3.min.js"></script><script src="vignette_files/sankey-1/sankey.js"></script><script src="vignette_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>scGPS introduction</h1>
                        <h4 class="author">Quan Nguyen and Michael Thompson</h4>
            
            <h4 class="date">2020-12-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/IMB-Computational-Genomics-Lab/scGPS/blob/master/vignettes/vignette.Rmd"><code>vignettes/vignette.Rmd</code></a></small>
      <div class="hidden name"><code>vignette.Rmd</code></div>

    </div>

    
    
<div id="installation-instruction" class="section level1">
<h1 class="hasAnchor">
<a href="#installation-instruction" class="anchor"></a>1. Installation instruction</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># To install scGPS from github (Depending on the configuration of the local</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co"># computer or HPC, possible custom C++ compilation may be required - see</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co"># installation trouble-shootings below)</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"IMB-Computational-Genomics-Lab/scGPS"</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co"># for C++ compilation trouble-shooting, manual download and installation can be</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co"># done from github</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">git clone https<span class="op">:</span><span class="er">//</span>github.com<span class="op">/</span>IMB<span class="op">-</span>Computational<span class="op">-</span>Genomics<span class="op">-</span>Lab<span class="op">/</span>scGPS</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co"># then check in scGPS/src if any of the precompiled (e.g.  those with *.so and</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co"># *.o) files exist and delete them before recompiling</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co"># then with the scGPS as the R working directory, manually install and load</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co"># using devtools functionality</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co"># Install the package</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17">devtools<span class="op">::</span><span class="kw">install</span>()</a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#load the package to the workspace </span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="kw">library</span>(scGPS)</a></code></pre></div>
</div>
<div id="a-simple-workflow-of-the-scgps" class="section level1">
<h1 class="hasAnchor">
<a href="#a-simple-workflow-of-the-scgps" class="anchor"></a>2. A simple workflow of the scGPS:</h1>
<p>The purpose of this workflow is to solve the following task:</p>
<ul>
<li>Given a mixed population with known subpopulations, estimate transition scores between these subpopulation.</li>
</ul>
<div id="create-scgps-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#create-scgps-objects" class="anchor"></a>2.1 Create scGPS objects</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># load mixed population 1 (loaded from day_2_cardio_cell_sample dataset, </span>
<span class="co"># named it as day2)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">scGPS</span><span class="op">)</span>

<span class="va">day2</span> <span class="op">&lt;-</span> <span class="va">day_2_cardio_cell_sample</span>
<span class="va">mixedpop1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_scGPS_object.html">new_scGPS_object</a></span><span class="op">(</span>ExpressionMatrix <span class="op">=</span> <span class="va">day2</span><span class="op">$</span><span class="va">dat2_counts</span>,
    GeneMetadata <span class="op">=</span> <span class="va">day2</span><span class="op">$</span><span class="va">dat2geneInfo</span>, CellMetadata <span class="op">=</span> <span class="va">day2</span><span class="op">$</span><span class="va">dat2_clusters</span><span class="op">)</span>

<span class="co"># load mixed population 2 (loaded from day_5_cardio_cell_sample dataset, </span>
<span class="co"># named it as day5)</span>
<span class="va">day5</span> <span class="op">&lt;-</span> <span class="va">day_5_cardio_cell_sample</span>
<span class="va">mixedpop2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_scGPS_object.html">new_scGPS_object</a></span><span class="op">(</span>ExpressionMatrix <span class="op">=</span> <span class="va">day5</span><span class="op">$</span><span class="va">dat5_counts</span>,
    GeneMetadata <span class="op">=</span> <span class="va">day5</span><span class="op">$</span><span class="va">dat5geneInfo</span>, CellMetadata <span class="op">=</span> <span class="va">day5</span><span class="op">$</span><span class="va">dat5_clusters</span><span class="op">)</span></code></pre></div>
</div>
<div id="run-prediction" class="section level2">
<h2 class="hasAnchor">
<a href="#run-prediction" class="anchor"></a>2.2 Run prediction</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># select a subpopulation</span>
<span class="va">c_selectID</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="co"># load gene list (this can be any lists of user selected genes)</span>
<span class="va">genes</span> <span class="op">&lt;-</span> <span class="va">training_gene_sample</span>
<span class="va">genes</span> <span class="op">&lt;-</span> <span class="va">genes</span><span class="op">$</span><span class="va">Merged_unique</span>
<span class="co"># load cluster information </span>
<span class="va">cluster_mixedpop1</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop1</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">cluster_mixedpop2</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="co">#run training (running nboots = 3 here, but recommend to use nboots = 50-100)</span>
<span class="va">LSOLDA_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootstrap_prediction.html">bootstrap_prediction</a></span><span class="op">(</span>nboots <span class="op">=</span> <span class="fl">3</span>, mixedpop1 <span class="op">=</span> <span class="va">mixedpop1</span>, 
    mixedpop2 <span class="op">=</span> <span class="va">mixedpop2</span>, genes <span class="op">=</span> <span class="va">genes</span>, c_selectID  <span class="op">=</span> <span class="va">c_selectID</span>,
    listData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>, cluster_mixedpop1 <span class="op">=</span> <span class="va">cluster_mixedpop1</span>, 
    cluster_mixedpop2 <span class="op">=</span> <span class="va">cluster_mixedpop2</span>, trainset_ratio <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">LSOLDA_dat</span><span class="op">)</span>
<span class="co">#&gt; [1] "Accuracy"          "ElasticNetGenes"   "Deviance"         </span>
<span class="co">#&gt; [4] "ElasticNetFit"     "LDAFit"            "predictor_S1"     </span>
<span class="co">#&gt; [7] "ElasticNetPredict" "LDAPredict"        "cell_results"</span></code></pre></div>
</div>
<div id="summarise-results" class="section level2">
<h2 class="hasAnchor">
<a href="#summarise-results" class="anchor"></a>2.3 Summarise results</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># summary results LDA</span>
<span class="va">sum_pred_lda</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summary_prediction_lda.html">summary_prediction_lda</a></span><span class="op">(</span>LSOLDA_dat <span class="op">=</span> <span class="va">LSOLDA_dat</span>, nPredSubpop <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="co"># summary results Lasso to show the percent of cells</span>
<span class="co"># classified as cells belonging </span>
<span class="va">sum_pred_lasso</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summary_prediction_lasso.html">summary_prediction_lasso</a></span><span class="op">(</span>LSOLDA_dat <span class="op">=</span> <span class="va">LSOLDA_dat</span>,
    nPredSubpop <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="co"># plot summary results </span>
<span class="va">plot_sum</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">sum_dat</span><span class="op">)</span><span class="op">{</span>
    <span class="va">sum_dat_tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">sum_dat</span><span class="op">)</span>
    <span class="va">sum_dat_tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">sum_dat_tf</span><span class="op">)</span>
    <span class="va">sum_dat_tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">sum_dat</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">sum_dat</span><span class="op">)</span><span class="op">]</span>,<span class="fl">1</span>,
        <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>
    <span class="va">sum_dat</span><span class="op">$</span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"ElasticNet for subpop"</span>,<span class="st">"sp"</span>,  <span class="va">sum_dat</span><span class="op">$</span><span class="va">names</span> <span class="op">)</span>
    <span class="va">sum_dat</span><span class="op">$</span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"in target mixedpop"</span>,<span class="st">"in p"</span>,  <span class="va">sum_dat</span><span class="op">$</span><span class="va">names</span><span class="op">)</span> 
    <span class="va">sum_dat</span><span class="op">$</span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"LDA for subpop"</span>,<span class="st">"sp"</span>,  <span class="va">sum_dat</span><span class="op">$</span><span class="va">names</span> <span class="op">)</span>
    <span class="va">sum_dat</span><span class="op">$</span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"in target mixedpop"</span>,<span class="st">"in p"</span>,  <span class="va">sum_dat</span><span class="op">$</span><span class="va">names</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">sum_dat_tf</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">sum_dat</span><span class="op">$</span><span class="va">names</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">sum_dat_tf</span>, las<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">plot_sum</span><span class="op">(</span><span class="va">sum_pred_lasso</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/summarise_results-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plot_sum</span><span class="op">(</span><span class="va">sum_pred_lda</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/summarise_results-2.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># summary accuracy to check the model accuracy in the leave-out test set </span>
<span class="fu"><a href="../reference/summary_accuracy.html">summary_accuracy</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">LSOLDA_dat</span><span class="op">)</span>
<span class="co">#&gt; [1] 59.43396 68.37209 61.21495</span>
<span class="co"># summary maximum deviance explained by the model </span>
<span class="fu"><a href="../reference/summary_deviance.html">summary_deviance</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">LSOLDA_dat</span><span class="op">)</span>
<span class="co">#&gt; $allDeviance</span>
<span class="co">#&gt; [1] "12.64" "5.29"  "12.2" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $DeviMax</span>
<span class="co">#&gt;          dat_DE$Dfd          Deviance           DEgenes</span>
<span class="co">#&gt; 1                 0              5.29    genes_cluster1</span>
<span class="co">#&gt; 2                 1              5.29    genes_cluster1</span>
<span class="co">#&gt; 3                 2              5.29    genes_cluster1</span>
<span class="co">#&gt; 4                 3              5.29    genes_cluster1</span>
<span class="co">#&gt; 5                 4              5.29    genes_cluster1</span>
<span class="co">#&gt; 6 remaining DEgenes remaining DEgenes remaining DEgenes</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $LassoGenesMax</span>
<span class="co">#&gt; NULL</span></code></pre></div>
</div>
</div>
<div id="a-complete-workflow-of-the-scgps" class="section level1">
<h1 class="hasAnchor">
<a href="#a-complete-workflow-of-the-scgps" class="anchor"></a>3. A complete workflow of the scGPS:</h1>
<p>The purpose of this workflow is to solve the following task:</p>
<ul>
<li>Given an unknown mixed population, find clusters and estimate relationship between clusters</li>
</ul>
<div id="identify-clusters-in-a-dataset-using-core" class="section level2">
<h2 class="hasAnchor">
<a href="#identify-clusters-in-a-dataset-using-core" class="anchor"></a>3.1 Identify clusters in a dataset using CORE</h2>
<p>(skip this step if clusters are known)</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># find clustering information in an expresion data using CORE</span>
<span class="va">day5</span> <span class="op">&lt;-</span> <span class="va">day_5_cardio_cell_sample</span>
<span class="va">cellnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">day5</span><span class="op">$</span><span class="va">dat5_counts</span><span class="op">)</span>
<span class="va">cluster</span> <span class="op">&lt;-</span><span class="va">day5</span><span class="op">$</span><span class="va">dat5_clusters</span>
<span class="va">cellnames</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Cluster"</span><span class="op">=</span><span class="va">cluster</span>, <span class="st">"cellBarcodes"</span> <span class="op">=</span> <span class="va">cellnames</span><span class="op">)</span>
<span class="va">mixedpop2</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/new_scGPS_object.html">new_scGPS_object</a></span><span class="op">(</span>ExpressionMatrix <span class="op">=</span> <span class="va">day5</span><span class="op">$</span><span class="va">dat5_counts</span>,
                    GeneMetadata <span class="op">=</span> <span class="va">day5</span><span class="op">$</span><span class="va">dat5geneInfo</span>, CellMetadata <span class="op">=</span> <span class="va">cellnames</span><span class="op">)</span>

<span class="va">CORE_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CORE_clustering.html">CORE_clustering</a></span><span class="op">(</span><span class="va">mixedpop2</span>, remove_outlier <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, PCA<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># to update the clustering information, users can ...</span>
<span class="va">key_height</span> <span class="op">&lt;-</span> <span class="va">CORE_cluster</span><span class="op">$</span><span class="va">optimalClust</span><span class="op">$</span><span class="va">KeyStats</span><span class="op">$</span><span class="va">Height</span>
<span class="va">optimal_res</span> <span class="op">&lt;-</span> <span class="va">CORE_cluster</span><span class="op">$</span><span class="va">optimalClust</span><span class="op">$</span><span class="va">OptimalRes</span>
<span class="va">optimal_index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">key_height</span> <span class="op">==</span> <span class="va">optimal_res</span><span class="op">)</span>

<span class="va">clustering_after_outlier_removal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span>
 <span class="va">CORE_cluster</span><span class="op">$</span><span class="va">Cluster</span><span class="op">[[</span><span class="va">optimal_index</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">corresponding_cells_after_outlier_removal</span> <span class="op">&lt;-</span> <span class="va">CORE_cluster</span><span class="op">$</span><span class="va">cellsForClustering</span>
<span class="va">original_cells_before_removal</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>
<span class="va">corresponding_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">corresponding_cells_after_outlier_removal</span>,
                            <span class="va">original_cells_before_removal</span> <span class="op">)</span>
<span class="co"># check the matching</span>
<span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">original_cells_before_removal</span><span class="op">[</span><span class="va">corresponding_index</span><span class="op">]</span><span class="op">)</span>,
         <span class="va">corresponding_cells_after_outlier_removal</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co"># create new object with the new clustering after removing outliers</span>
<span class="va">mixedpop2_post_clustering</span> <span class="op">&lt;-</span> <span class="va">mixedpop2</span><span class="op">[</span>,<span class="va">corresponding_index</span><span class="op">]</span>
<span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2_post_clustering</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">clustering_after_outlier_removal</span></code></pre></div>
</div>
<div id="identify-clusters-in-a-dataset-using-score-stable-clustering-at-optimal-resolution" class="section level2">
<h2 class="hasAnchor">
<a href="#identify-clusters-in-a-dataset-using-score-stable-clustering-at-optimal-resolution" class="anchor"></a>3.2 Identify clusters in a dataset using SCORE (Stable Clustering at Optimal REsolution)</h2>
<p>(skip this step if clusters are known)</p>
<p>(SCORE aims to get stable subpopulation results by introducing bagging aggregation and bootstrapping to the CORE algorithm)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># find clustering information in an expresion data using SCORE</span>
<span class="va">day5</span> <span class="op">&lt;-</span> <span class="va">day_5_cardio_cell_sample</span>
<span class="va">cellnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">day5</span><span class="op">$</span><span class="va">dat5_counts</span><span class="op">)</span>
<span class="va">cluster</span> <span class="op">&lt;-</span><span class="va">day5</span><span class="op">$</span><span class="va">dat5_clusters</span>
<span class="va">cellnames</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Cluster"</span><span class="op">=</span><span class="va">cluster</span>, <span class="st">"cellBarcodes"</span> <span class="op">=</span> <span class="va">cellnames</span><span class="op">)</span>
<span class="va">mixedpop2</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/new_scGPS_object.html">new_scGPS_object</a></span><span class="op">(</span>ExpressionMatrix <span class="op">=</span> <span class="va">day5</span><span class="op">$</span><span class="va">dat5_counts</span>,
                    GeneMetadata <span class="op">=</span> <span class="va">day5</span><span class="op">$</span><span class="va">dat5geneInfo</span>, CellMetadata <span class="op">=</span> <span class="va">cellnames</span> <span class="op">)</span>

<span class="va">SCORE_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CORE_bagging.html">CORE_bagging</a></span><span class="op">(</span><span class="va">mixedpop2</span>, remove_outlier <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, PCA<span class="op">=</span><span class="cn">FALSE</span>,
                                bagging_run <span class="op">=</span> <span class="fl">20</span>, subsample_proportion <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span></code></pre></div>
</div>
<div id="visualise-all-cluster-results-in-all-iterations" class="section level2">
<h2 class="hasAnchor">
<a href="#visualise-all-cluster-results-in-all-iterations" class="anchor"></a>3.3 Visualise all cluster results in all iterations</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; null device </span>
<span class="co">#&gt;           1</span>
<span class="co">##3.2.1 plot CORE clustering</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_CORE.html">plot_CORE</a></span><span class="op">(</span><span class="va">CORE_cluster</span><span class="op">$</span><span class="va">tree</span>, <span class="va">CORE_cluster</span><span class="op">$</span><span class="va">Cluster</span>, 
    color_branch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#208eb7"</span>, <span class="st">"#6ce9d3"</span>, <span class="st">"#1c5e39"</span>, <span class="st">"#8fca40"</span>, <span class="st">"#154975"</span>,
        <span class="st">"#b1c8eb"</span><span class="op">)</span><span class="op">)</span>
<span class="va">p1</span>
<span class="co">#&gt; $mar</span>
<span class="co">#&gt; [1] 1 5 0 1</span>
<span class="co">#extract optimal index identified by CORE</span>
<span class="va">key_height</span> <span class="op">&lt;-</span> <span class="va">CORE_cluster</span><span class="op">$</span><span class="va">optimalClust</span><span class="op">$</span><span class="va">KeyStats</span><span class="op">$</span><span class="va">Height</span>
<span class="va">optimal_res</span> <span class="op">&lt;-</span> <span class="va">CORE_cluster</span><span class="op">$</span><span class="va">optimalClust</span><span class="op">$</span><span class="va">OptimalRes</span>
<span class="va">optimal_index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">key_height</span> <span class="op">==</span> <span class="va">optimal_res</span><span class="op">)</span>
<span class="co">#plot one optimal clustering bar</span>
<span class="fu"><a href="../reference/plot_optimal_CORE.html">plot_optimal_CORE</a></span><span class="op">(</span>original_tree<span class="op">=</span> <span class="va">CORE_cluster</span><span class="op">$</span><span class="va">tree</span>,
                 optimal_cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">CORE_cluster</span><span class="op">$</span><span class="va">Cluster</span><span class="op">[</span><span class="va">optimal_index</span><span class="op">]</span><span class="op">)</span>,
                 shift <span class="op">=</span> <span class="op">-</span><span class="fl">2000</span><span class="op">)</span>
<span class="co">#&gt; Ordering and assigning labels...</span>
<span class="co">#&gt; 2</span>
<span class="co">#&gt; 162335NA</span>
<span class="co">#&gt; 3</span>
<span class="co">#&gt; 162335423</span>
<span class="co">#&gt; Plotting the colored dendrogram now....</span>
<span class="co">#&gt; Plotting the bar underneath now....</span>

<span class="co">##3.2.2 plot SCORE clustering</span>
<span class="co">#plot all clustering bars</span>
<span class="fu"><a href="../reference/plot_CORE.html">plot_CORE</a></span><span class="op">(</span><span class="va">SCORE_test</span><span class="op">$</span><span class="va">tree</span>, list_clusters <span class="op">=</span> <span class="va">SCORE_test</span><span class="op">$</span><span class="va">Cluster</span><span class="op">)</span>
<span class="co">#plot one stable optimal clustering bar</span>
<span class="fu"><a href="../reference/plot_optimal_CORE.html">plot_optimal_CORE</a></span><span class="op">(</span>original_tree<span class="op">=</span> <span class="va">SCORE_test</span><span class="op">$</span><span class="va">tree</span>,
                 optimal_cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">SCORE_test</span><span class="op">$</span><span class="va">Cluster</span><span class="op">[</span>
                    <span class="va">SCORE_test</span><span class="op">$</span><span class="va">optimal_index</span><span class="op">]</span><span class="op">)</span>,
                 shift <span class="op">=</span> <span class="op">-</span><span class="fl">100</span><span class="op">)</span>
<span class="co">#&gt; Ordering and assigning labels...</span>
<span class="co">#&gt; 2</span>
<span class="co">#&gt; 162335NA</span>
<span class="co">#&gt; 3</span>
<span class="co">#&gt; 162335423</span>
<span class="co">#&gt; Plotting the colored dendrogram now....</span>
<span class="co">#&gt; Plotting the bar underneath now....</span></code></pre></div>
</div>
<div id="compare-clustering-results-with-other-dimensional-reduction-methods-e-g--tsne" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-clustering-results-with-other-dimensional-reduction-methods-e-g--tsne" class="anchor"></a>3.4 Compare clustering results with other dimensional reduction methods (e.g., tSNE)</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tSNE.html">tSNE</a></span><span class="op">(</span>expression.mat<span class="op">=</span><span class="fu">assay</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Preparing PCA inputs using the top 1500 genes ...</span>
<span class="co">#&gt; Computing PCA values...</span>
<span class="co">#&gt; Running tSNE ...</span>
<span class="va">p2</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/plot_reduced.html">plot_reduced</a></span><span class="op">(</span><span class="va">t</span>, color_fac <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
                      palletes <span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Use of `reduced_dat_toPlot$Dim1` is discouraged. Use `Dim1` instead.</span>
<span class="co">#&gt; Warning: Use of `reduced_dat_toPlot$Dim2` is discouraged. Use `Dim2` instead.</span>
<span class="va">p2</span></code></pre></div>
<p><img src="vignette_files/figure-html/compare_clustering-1.png" width="480"></p>
</div>
<div id="find-gene-markers-and-annotate-clusters" class="section level2">
<h2 class="hasAnchor">
<a href="#find-gene-markers-and-annotate-clusters" class="anchor"></a>3.5 Find gene markers and annotate clusters</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#load gene list (this can be any lists of user-selected genes)</span>
<span class="va">genes</span> <span class="op">&lt;-</span><span class="va">training_gene_sample</span>
<span class="va">genes</span> <span class="op">&lt;-</span><span class="va">genes</span><span class="op">$</span><span class="va">Merged_unique</span>

<span class="co">#the gene list can also be objectively identified by differential expression</span>
<span class="co">#analysis cluster information is requied for find_markers. Here, we use</span>
<span class="co">#CORE results.</span>

<span class="co">#colData(mixedpop2)[,1] &lt;- unlist(SCORE_test$Cluster[SCORE_test$optimal_index])</span>

<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">locfit</span><span class="op">)</span><span class="op">)</span>

<span class="va">DEgenes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_markers.html">find_markers</a></span><span class="op">(</span>expression_matrix<span class="op">=</span><span class="fu">assay</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span>,
                            cluster <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,
                            selected_cluster<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="co">#the output contains dataframes for each cluster.</span>
<span class="co">#the data frame contains all genes, sorted by p-values</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">DEgenes</span><span class="op">)</span>
<span class="co">#&gt; [1] "baseMean"       "log2FoldChange" "lfcSE"          "stat"          </span>
<span class="co">#&gt; [5] "pvalue"         "padj"           "id"</span>

<span class="co">#you can annotate the identified clusters</span>
<span class="va">DEgeneList_1vsOthers</span> <span class="op">&lt;-</span> <span class="va">DEgenes</span><span class="op">$</span><span class="va">DE_Subpop1vsRemaining</span><span class="op">$</span><span class="va">id</span>

<span class="co">#users need to check the format of the gene input to make sure they are</span>
<span class="co">#consistent to the gene names in the expression matrix</span>

<span class="co">#the following command saves the file "PathwayEnrichment.xlsx" to the</span>
<span class="co">#working dir</span>
<span class="co">#use 500 top DE genes</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://guangchuangyu.github.io/software/DOSE">DOSE</a></span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://guangchuangyu.github.io/software/ReactomePA">ReactomePA</a></span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://guangchuangyu.github.io/software/clusterProfiler">clusterProfiler</a></span><span class="op">)</span><span class="op">)</span>
<span class="va">genes500</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">DEgeneList_1vsOthers</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">enrichment_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/annotate_clusters.html">annotate_clusters</a></span><span class="op">(</span><span class="va">genes</span>, pvalueCutoff<span class="op">=</span><span class="fl">0.05</span>, gene_symbol<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="co">#the enrichment outputs can be displayed by running</span>
<span class="fu">clusterProfiler</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/dotplot.html">dotplot</a></span><span class="op">(</span><span class="va">enrichment_test</span>, showCategory<span class="op">=</span><span class="fl">10</span>, font.size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/find_markers-1.png" width="672"></p>
</div>
</div>
<div id="relationship-between-clusters-within-one-sample-or-between-two-samples" class="section level1">
<h1 class="hasAnchor">
<a href="#relationship-between-clusters-within-one-sample-or-between-two-samples" class="anchor"></a>4. Relationship between clusters within one sample or between two samples</h1>
<p>The purpose of this workflow is to solve the following task:</p>
<ul>
<li>Given one or two unknown mixed population(s) and clusters in each mixed population, estimate</li>
<li>Visualise relationship between clusters*</li>
</ul>
<div id="start-the-scgps-prediction-to-find-relationship-between-clusters" class="section level2">
<h2 class="hasAnchor">
<a href="#start-the-scgps-prediction-to-find-relationship-between-clusters" class="anchor"></a>4.1 Start the scGPS prediction to find relationship between clusters</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#select a subpopulation, and input gene list</span>
<span class="va">c_selectID</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="co">#note make sure the format for genes input here is the same to the format</span>
<span class="co">#for genes in the mixedpop1 and mixedpop2</span>
<span class="va">genes</span> <span class="op">=</span> <span class="va">DEgenes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">]</span>

<span class="co">#run the test bootstrap with nboots = 2 runs</span>

<span class="va">cluster_mixedpop1</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop1</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">cluster_mixedpop2</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>

<span class="va">LSOLDA_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootstrap_prediction.html">bootstrap_prediction</a></span><span class="op">(</span>nboots <span class="op">=</span> <span class="fl">2</span>, mixedpop1 <span class="op">=</span> <span class="va">mixedpop1</span>,
                             mixedpop2 <span class="op">=</span> <span class="va">mixedpop2</span>, genes <span class="op">=</span> <span class="va">genes</span>, 
                             c_selectID  <span class="op">=</span> <span class="va">c_selectID</span>,
                             listData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>,
                             cluster_mixedpop1 <span class="op">=</span> <span class="va">cluster_mixedpop1</span>,
                             cluster_mixedpop2 <span class="op">=</span> <span class="va">cluster_mixedpop2</span><span class="op">)</span></code></pre></div>
</div>
<div id="display-summary-results-for-the-prediction" class="section level2">
<h2 class="hasAnchor">
<a href="#display-summary-results-for-the-prediction" class="anchor"></a>4.2 Display summary results for the prediction</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#get the number of rows for the summary matrix</span>
<span class="va">row_cluster</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="co">#summary results LDA to to show the percent of cells classified as cells</span>
<span class="co">#belonging by LDA classifier</span>
<span class="fu"><a href="../reference/summary_prediction_lda.html">summary_prediction_lda</a></span><span class="op">(</span>LSOLDA_dat<span class="op">=</span><span class="va">LSOLDA_dat</span>, nPredSubpop <span class="op">=</span> <span class="va">row_cluster</span> <span class="op">)</span>
<span class="co">#&gt;                 V1               V2                                names</span>
<span class="co">#&gt; 1 78.0748663101604 91.9786096256685 LDA for subpop 1 in target mixedpop2</span>
<span class="co">#&gt; 2 78.5714285714286 31.4285714285714 LDA for subpop 2 in target mixedpop2</span>
<span class="co">#&gt; 3 67.6691729323308 71.4285714285714 LDA for subpop 3 in target mixedpop2</span>
<span class="co">#&gt; 4               80             72.5 LDA for subpop 4 in target mixedpop2</span>

<span class="co">#summary results Lasso to show the percent of cells classified as cells</span>
<span class="co">#belonging by Lasso classifier</span>
<span class="fu"><a href="../reference/summary_prediction_lasso.html">summary_prediction_lasso</a></span><span class="op">(</span>LSOLDA_dat<span class="op">=</span><span class="va">LSOLDA_dat</span>, nPredSubpop <span class="op">=</span> <span class="va">row_cluster</span><span class="op">)</span>
<span class="co">#&gt;                 V1               V2                                      names</span>
<span class="co">#&gt; 1 17.1122994652406 56.6844919786096 ElasticNet for subpop1 in target mixedpop2</span>
<span class="co">#&gt; 2 99.2857142857143              100 ElasticNet for subpop2 in target mixedpop2</span>
<span class="co">#&gt; 3 94.7368421052632 87.9699248120301 ElasticNet for subpop3 in target mixedpop2</span>
<span class="co">#&gt; 4             97.5               95 ElasticNet for subpop4 in target mixedpop2</span>

<span class="co"># summary maximum deviance explained by the model during the model training</span>
<span class="fu"><a href="../reference/summary_deviance.html">summary_deviance</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">LSOLDA_dat</span><span class="op">)</span>
<span class="co">#&gt; $allDeviance</span>
<span class="co">#&gt; [1] "46.95" "53.35"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $DeviMax</span>
<span class="co">#&gt;           dat_DE$Dfd          Deviance           DEgenes</span>
<span class="co">#&gt; 1                  0             53.35    genes_cluster1</span>
<span class="co">#&gt; 2                  1             53.35    genes_cluster1</span>
<span class="co">#&gt; 3                  4             53.35    genes_cluster1</span>
<span class="co">#&gt; 4                  6             53.35    genes_cluster1</span>
<span class="co">#&gt; 5                  7             53.35    genes_cluster1</span>
<span class="co">#&gt; 6                  8             53.35    genes_cluster1</span>
<span class="co">#&gt; 7                 10             53.35    genes_cluster1</span>
<span class="co">#&gt; 8                 12             53.35    genes_cluster1</span>
<span class="co">#&gt; 9                 14             53.35    genes_cluster1</span>
<span class="co">#&gt; 10                17             53.35    genes_cluster1</span>
<span class="co">#&gt; 11                20             53.35    genes_cluster1</span>
<span class="co">#&gt; 12                22             53.35    genes_cluster1</span>
<span class="co">#&gt; 13                23             53.35    genes_cluster1</span>
<span class="co">#&gt; 14                27             53.35    genes_cluster1</span>
<span class="co">#&gt; 15 remaining DEgenes remaining DEgenes remaining DEgenes</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $LassoGenesMax</span>
<span class="co">#&gt; NULL</span>

<span class="co"># summary accuracy to check the model accuracy in the leave-out test set</span>
<span class="fu"><a href="../reference/summary_accuracy.html">summary_accuracy</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">LSOLDA_dat</span><span class="op">)</span>
<span class="co">#&gt; [1] 69.19643 62.05357</span></code></pre></div>
</div>
<div id="plot-the-relationship-between-clusters-in-one-sample" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-the-relationship-between-clusters-in-one-sample" class="anchor"></a>4.3 Plot the relationship between clusters in one sample</h2>
<p>Here we look at one example use case to find relationship between clusters within one sample or between two sample</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#run prediction for 3 clusters</span>
<span class="va">cluster_mixedpop1</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop1</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">cluster_mixedpop2</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="co">#cluster_mixedpop2 &lt;- as.numeric(as.vector(colData(mixedpop2)[,1]))</span>

<span class="va">c_selectID</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="co">#top 200 gene markers distinguishing cluster 1</span>
<span class="va">genes</span> <span class="op">=</span> <span class="va">DEgenes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>

<span class="va">LSOLDA_dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootstrap_prediction.html">bootstrap_prediction</a></span><span class="op">(</span>nboots <span class="op">=</span> <span class="fl">2</span>, mixedpop1 <span class="op">=</span> <span class="va">mixedpop2</span>,
                        mixedpop2 <span class="op">=</span> <span class="va">mixedpop2</span>, genes<span class="op">=</span><span class="va">genes</span>, <span class="va">c_selectID</span>, 
                        listData <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>,
                        cluster_mixedpop1 <span class="op">=</span> <span class="va">cluster_mixedpop2</span>,
                        cluster_mixedpop2 <span class="op">=</span> <span class="va">cluster_mixedpop2</span><span class="op">)</span>

<span class="va">c_selectID</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">genes</span> <span class="op">=</span> <span class="va">DEgenes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>

<span class="va">LSOLDA_dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootstrap_prediction.html">bootstrap_prediction</a></span><span class="op">(</span>nboots <span class="op">=</span> <span class="fl">2</span>,mixedpop1 <span class="op">=</span> <span class="va">mixedpop2</span>,
                        mixedpop2 <span class="op">=</span> <span class="va">mixedpop2</span>, genes<span class="op">=</span><span class="va">genes</span>, <span class="va">c_selectID</span>, 
                        listData <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>,
                        cluster_mixedpop1 <span class="op">=</span> <span class="va">cluster_mixedpop2</span>,
                        cluster_mixedpop2 <span class="op">=</span> <span class="va">cluster_mixedpop2</span><span class="op">)</span>

<span class="va">c_selectID</span> <span class="op">&lt;-</span> <span class="fl">3</span>
<span class="va">genes</span> <span class="op">=</span> <span class="va">DEgenes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>
<span class="va">LSOLDA_dat3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootstrap_prediction.html">bootstrap_prediction</a></span><span class="op">(</span>nboots <span class="op">=</span> <span class="fl">2</span>,mixedpop1 <span class="op">=</span> <span class="va">mixedpop2</span>,
                        mixedpop2 <span class="op">=</span> <span class="va">mixedpop2</span>, genes<span class="op">=</span><span class="va">genes</span>, <span class="va">c_selectID</span>, 
                        listData <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>,
                        cluster_mixedpop1 <span class="op">=</span> <span class="va">cluster_mixedpop2</span>,
                        cluster_mixedpop2 <span class="op">=</span> <span class="va">cluster_mixedpop2</span><span class="op">)</span>

<span class="va">c_selectID</span> <span class="op">&lt;-</span> <span class="fl">4</span>
<span class="va">genes</span> <span class="op">=</span> <span class="va">DEgenes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>
<span class="va">LSOLDA_dat4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootstrap_prediction.html">bootstrap_prediction</a></span><span class="op">(</span>nboots <span class="op">=</span> <span class="fl">2</span>,mixedpop1 <span class="op">=</span> <span class="va">mixedpop2</span>,
                        mixedpop2 <span class="op">=</span> <span class="va">mixedpop2</span>, genes<span class="op">=</span><span class="va">genes</span>, <span class="va">c_selectID</span>, 
                        listData <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>,
                        cluster_mixedpop1 <span class="op">=</span> <span class="va">cluster_mixedpop2</span>,
                        cluster_mixedpop2 <span class="op">=</span> <span class="va">cluster_mixedpop2</span><span class="op">)</span>


<span class="co">#prepare table input for sankey plot</span>

<span class="va">LASSO_C1S2</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reformat_LASSO.html">reformat_LASSO</a></span><span class="op">(</span>c_selectID<span class="op">=</span><span class="fl">1</span>, mp_selectID <span class="op">=</span> <span class="fl">2</span>,
                             LSOLDA_dat<span class="op">=</span><span class="va">LSOLDA_dat1</span>,
                             nPredSubpop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span>
                                <span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
                             Nodes_group <span class="op">=</span><span class="st">"#7570b3"</span><span class="op">)</span>

<span class="va">LASSO_C2S2</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reformat_LASSO.html">reformat_LASSO</a></span><span class="op">(</span>c_selectID<span class="op">=</span><span class="fl">2</span>, mp_selectID <span class="op">=</span><span class="fl">2</span>,
                             LSOLDA_dat<span class="op">=</span><span class="va">LSOLDA_dat2</span>,
                             nPredSubpop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span>
                                <span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
                             Nodes_group <span class="op">=</span><span class="st">"#1b9e77"</span><span class="op">)</span>

<span class="va">LASSO_C3S2</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reformat_LASSO.html">reformat_LASSO</a></span><span class="op">(</span>c_selectID<span class="op">=</span><span class="fl">3</span>, mp_selectID <span class="op">=</span><span class="fl">2</span>,
                             LSOLDA_dat<span class="op">=</span><span class="va">LSOLDA_dat3</span>,
                             nPredSubpop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span>
                                <span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
                             Nodes_group <span class="op">=</span><span class="st">"#e7298a"</span><span class="op">)</span>

<span class="va">LASSO_C4S2</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reformat_LASSO.html">reformat_LASSO</a></span><span class="op">(</span>c_selectID<span class="op">=</span><span class="fl">4</span>, mp_selectID <span class="op">=</span><span class="fl">2</span>,
                             LSOLDA_dat<span class="op">=</span><span class="va">LSOLDA_dat4</span>,
                             nPredSubpop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span>
                                <span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
                             Nodes_group <span class="op">=</span><span class="st">"#00FFFF"</span><span class="op">)</span>

<span class="va">combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">LASSO_C1S2</span>,<span class="va">LASSO_C2S2</span>,<span class="va">LASSO_C3S2</span>, <span class="va">LASSO_C4S2</span> <span class="op">)</span>
<span class="va">combined</span> <span class="op">&lt;-</span> <span class="va">combined</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">combined</span><span class="op">$</span><span class="va">Value</span><span class="op">)</span> <span class="op">!=</span> <span class="cn">TRUE</span>,<span class="op">]</span>

<span class="va">nboots</span> <span class="op">=</span> <span class="fl">2</span>
<span class="co">#links: source, target, value</span>
<span class="co">#source: node, nodegroup</span>
<span class="va">combined_D3obj</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Nodes<span class="op">=</span><span class="va">combined</span><span class="op">[</span>,<span class="op">(</span><span class="va">nboots</span><span class="op">+</span><span class="fl">3</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">nboots</span><span class="op">+</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,
                     Links<span class="op">=</span><span class="va">combined</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">(</span><span class="va">nboots</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">nboots</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">combined</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=networkD3">networkD3</a></span><span class="op">)</span>

<span class="va">Node_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span><span class="op">$</span><span class="va">Source</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">Node_target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span><span class="op">$</span><span class="va">Target</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">Node_all</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Node_source</span>, <span class="va">Node_target</span><span class="op">)</span><span class="op">)</span>

<span class="co">#assign IDs for Source (start from 0)</span>
<span class="va">Source</span> <span class="op">&lt;-</span><span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span><span class="op">$</span><span class="va">Source</span>
<span class="va">Target</span> <span class="op">&lt;-</span> <span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span><span class="op">$</span><span class="va">Target</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Node_all</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
   <span class="va">Source</span><span class="op">[</span><span class="va">Source</span><span class="op">==</span><span class="va">Node_all</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>
   <span class="va">Target</span><span class="op">[</span><span class="va">Target</span><span class="op">==</span><span class="va">Node_all</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>
<span class="op">}</span>
<span class="co"># </span>
<span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span><span class="op">$</span><span class="va">Source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Source</span><span class="op">)</span>
<span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span><span class="op">$</span><span class="va">Target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Target</span><span class="op">)</span>
<span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span><span class="op">$</span><span class="va">LinkColor</span> <span class="op">&lt;-</span> <span class="va">combined</span><span class="op">$</span><span class="va">NodeGroup</span>

<span class="co">#prepare node info</span>
<span class="va">node_df</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Node<span class="op">=</span><span class="va">Node_all</span><span class="op">)</span>
<span class="va">node_df</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Node_all</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span><span class="op">)</span>
<span class="va">Color</span> <span class="op">&lt;-</span> <span class="va">combined</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">Node</span>, color<span class="op">=</span><span class="va">NodeGroup</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>
<span class="va">node_df</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="va">Color</span><span class="op">$</span><span class="va">color</span>

<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=networkD3">networkD3</a></span><span class="op">)</span><span class="op">)</span>
<span class="va">p1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/networkD3/man/sankeyNetwork.html">sankeyNetwork</a></span><span class="op">(</span>Links <span class="op">=</span><span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span>, Nodes <span class="op">=</span> <span class="va">node_df</span>,
                 Value <span class="op">=</span> <span class="st">"Value"</span>, NodeGroup <span class="op">=</span><span class="st">"color"</span>, LinkGroup <span class="op">=</span> <span class="st">"LinkColor"</span>, 
                 NodeID<span class="op">=</span><span class="st">"Node"</span>, Source<span class="op">=</span><span class="st">"Source"</span>, Target<span class="op">=</span><span class="st">"Target"</span>, fontSize <span class="op">=</span> <span class="fl">22</span><span class="op">)</span>
<span class="va">p1</span></code></pre></div>
<div id="htmlwidget-ded1c95d44d74c7f5791" style="width:480px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-ded1c95d44d74c7f5791">{"x":{"links":{"source":[0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3],"target":[0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3],"value":[71.3903743315508,0,9.39849624060152,17.5,31.0160427807486,97.8571428571428,2.63157894736842,30,44.1176470588236,4.28571428571428,60.9022556390977,22.5,55.8823529411764,30.3571428571429,29.6992481203007,56.25],"group":["#7570b3","#7570b3","#7570b3","#7570b3","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#e7298a","#e7298a","#e7298a","#e7298a","#00FFFF","#00FFFF","#00FFFF","#00FFFF"]},"nodes":{"name":["C1_MP2","C2_MP2","C3_MP2","C4_MP2"],"group":["#7570b3","#1b9e77","#e7298a","#00FFFF"]},"options":{"NodeID":"Node","NodeGroup":"color","LinkGroup":"LinkColor","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":22,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#saveNetwork(p1, file = paste0(path,'Subpopulation_Net.html'))</span></code></pre></div>
</div>
<div id="plot-the-relationship-between-clusters-in-two-samples" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-the-relationship-between-clusters-in-two-samples" class="anchor"></a>4.3 Plot the relationship between clusters in two samples</h2>
<p>Here we look at one example use case to find relationship between clusters within one sample or between two sample</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#run prediction for 3 clusters</span>
<span class="va">cluster_mixedpop1</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop1</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">cluster_mixedpop2</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">row_cluster</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">mixedpop2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="va">c_selectID</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="co">#top 200 gene markers distinguishing cluster 1</span>
<span class="va">genes</span> <span class="op">=</span> <span class="va">DEgenes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>
<span class="va">LSOLDA_dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootstrap_prediction.html">bootstrap_prediction</a></span><span class="op">(</span>nboots <span class="op">=</span> <span class="fl">2</span>, mixedpop1 <span class="op">=</span> <span class="va">mixedpop1</span>,
                        mixedpop2 <span class="op">=</span> <span class="va">mixedpop2</span>, genes<span class="op">=</span><span class="va">genes</span>, <span class="va">c_selectID</span>, 
                        listData <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>,
                        cluster_mixedpop1 <span class="op">=</span> <span class="va">cluster_mixedpop1</span>,
                        cluster_mixedpop2 <span class="op">=</span> <span class="va">cluster_mixedpop2</span><span class="op">)</span>


<span class="va">c_selectID</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">genes</span> <span class="op">=</span> <span class="va">DEgenes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>
<span class="va">LSOLDA_dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootstrap_prediction.html">bootstrap_prediction</a></span><span class="op">(</span>nboots <span class="op">=</span> <span class="fl">2</span>,mixedpop1 <span class="op">=</span> <span class="va">mixedpop1</span>,
                        mixedpop2 <span class="op">=</span> <span class="va">mixedpop2</span>, genes<span class="op">=</span><span class="va">genes</span>, <span class="va">c_selectID</span>, 
                        listData <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>,
                        cluster_mixedpop1 <span class="op">=</span> <span class="va">cluster_mixedpop1</span>,
                        cluster_mixedpop2 <span class="op">=</span> <span class="va">cluster_mixedpop2</span><span class="op">)</span>

<span class="va">c_selectID</span> <span class="op">&lt;-</span> <span class="fl">3</span>
<span class="va">genes</span> <span class="op">=</span> <span class="va">DEgenes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>
<span class="va">LSOLDA_dat3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootstrap_prediction.html">bootstrap_prediction</a></span><span class="op">(</span>nboots <span class="op">=</span> <span class="fl">2</span>,mixedpop1 <span class="op">=</span> <span class="va">mixedpop1</span>,
                        mixedpop2 <span class="op">=</span> <span class="va">mixedpop2</span>, genes<span class="op">=</span><span class="va">genes</span>, <span class="va">c_selectID</span>, 
                        listData <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>,
                        cluster_mixedpop1 <span class="op">=</span> <span class="va">cluster_mixedpop1</span>,
                        cluster_mixedpop2 <span class="op">=</span> <span class="va">cluster_mixedpop2</span><span class="op">)</span>

<span class="co">#prepare table input for sankey plot</span>

<span class="va">LASSO_C1S1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reformat_LASSO.html">reformat_LASSO</a></span><span class="op">(</span>c_selectID<span class="op">=</span><span class="fl">1</span>, mp_selectID <span class="op">=</span> <span class="fl">1</span>,
                             LSOLDA_dat<span class="op">=</span><span class="va">LSOLDA_dat1</span>, nPredSubpop <span class="op">=</span> <span class="va">row_cluster</span>, 
                             Nodes_group <span class="op">=</span> <span class="st">"#7570b3"</span><span class="op">)</span>

<span class="va">LASSO_C2S1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reformat_LASSO.html">reformat_LASSO</a></span><span class="op">(</span>c_selectID<span class="op">=</span><span class="fl">2</span>, mp_selectID <span class="op">=</span> <span class="fl">1</span>,
                             LSOLDA_dat<span class="op">=</span><span class="va">LSOLDA_dat2</span>, nPredSubpop <span class="op">=</span> <span class="va">row_cluster</span>, 
                             Nodes_group <span class="op">=</span> <span class="st">"#1b9e77"</span><span class="op">)</span>

<span class="va">LASSO_C3S1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reformat_LASSO.html">reformat_LASSO</a></span><span class="op">(</span>c_selectID<span class="op">=</span><span class="fl">3</span>, mp_selectID <span class="op">=</span> <span class="fl">1</span>,
                             LSOLDA_dat<span class="op">=</span><span class="va">LSOLDA_dat3</span>, nPredSubpop <span class="op">=</span> <span class="va">row_cluster</span>, 
                             Nodes_group <span class="op">=</span> <span class="st">"#e7298a"</span><span class="op">)</span>


<span class="va">combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">LASSO_C1S1</span>,<span class="va">LASSO_C2S1</span>,<span class="va">LASSO_C3S1</span><span class="op">)</span>

<span class="va">nboots</span> <span class="op">=</span> <span class="fl">2</span>
<span class="co">#links: source, target, value</span>
<span class="co">#source: node, nodegroup</span>
<span class="va">combined_D3obj</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Nodes<span class="op">=</span><span class="va">combined</span><span class="op">[</span>,<span class="op">(</span><span class="va">nboots</span><span class="op">+</span><span class="fl">3</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">nboots</span><span class="op">+</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,
                     Links<span class="op">=</span><span class="va">combined</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">(</span><span class="va">nboots</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">nboots</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">combined</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">combined</span> <span class="op">&lt;-</span> <span class="va">combined</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">combined</span><span class="op">$</span><span class="va">Value</span><span class="op">)</span> <span class="op">!=</span> <span class="cn">TRUE</span>,<span class="op">]</span>


<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=networkD3">networkD3</a></span><span class="op">)</span>

<span class="va">Node_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span><span class="op">$</span><span class="va">Source</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">Node_target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span><span class="op">$</span><span class="va">Target</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">Node_all</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Node_source</span>, <span class="va">Node_target</span><span class="op">)</span><span class="op">)</span>

<span class="co">#assign IDs for Source (start from 0)</span>
<span class="va">Source</span> <span class="op">&lt;-</span><span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span><span class="op">$</span><span class="va">Source</span>
<span class="va">Target</span> <span class="op">&lt;-</span> <span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span><span class="op">$</span><span class="va">Target</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Node_all</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
   <span class="va">Source</span><span class="op">[</span><span class="va">Source</span><span class="op">==</span><span class="va">Node_all</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>
   <span class="va">Target</span><span class="op">[</span><span class="va">Target</span><span class="op">==</span><span class="va">Node_all</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>
<span class="op">}</span>

<span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span><span class="op">$</span><span class="va">Source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Source</span><span class="op">)</span>
<span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span><span class="op">$</span><span class="va">Target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Target</span><span class="op">)</span>
<span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span><span class="op">$</span><span class="va">LinkColor</span> <span class="op">&lt;-</span> <span class="va">combined</span><span class="op">$</span><span class="va">NodeGroup</span>

<span class="co">#prepare node info</span>
<span class="va">node_df</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Node<span class="op">=</span><span class="va">Node_all</span><span class="op">)</span>
<span class="va">node_df</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Node_all</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">node_df</span><span class="op">$</span><span class="va">Node</span><span class="op">)</span><span class="op">)</span>
<span class="va">getPalette</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">9</span>, <span class="st">"Set1"</span><span class="op">)</span><span class="op">)</span>
<span class="va">Color</span> <span class="op">=</span> <span class="fu">getPalette</span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">node_df</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="va">Color</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=networkD3">networkD3</a></span><span class="op">)</span><span class="op">)</span>
<span class="va">p1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/networkD3/man/sankeyNetwork.html">sankeyNetwork</a></span><span class="op">(</span>Links <span class="op">=</span><span class="va">combined_D3obj</span><span class="op">$</span><span class="va">Links</span>, Nodes <span class="op">=</span> <span class="va">node_df</span>,
                 Value <span class="op">=</span> <span class="st">"Value"</span>, NodeGroup <span class="op">=</span><span class="st">"color"</span>, LinkGroup <span class="op">=</span> <span class="st">"LinkColor"</span>,
                 NodeID<span class="op">=</span><span class="st">"Node"</span>, Source<span class="op">=</span><span class="st">"Source"</span>, Target<span class="op">=</span><span class="st">"Target"</span>, fontSize <span class="op">=</span> <span class="fl">22</span><span class="op">)</span>
<span class="va">p1</span></code></pre></div>
<div id="htmlwidget-b9f9b81b6f0a6ca36a0f" style="width:480px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-b9f9b81b6f0a6ca36a0f">{"x":{"links":{"source":[0,0,0,0,1,1,1,1,2,2,2,2],"target":[3,4,5,6,3,4,5,6,3,4,5,6],"value":[53.475935828877,55.7142857142857,50.375939849624,57.5,17.6470588235294,30.7142857142857,52.2556390977443,41.25,64.7058823529411,3.21428571428571,12.406015037594,16.25],"group":["#7570b3","#7570b3","#7570b3","#7570b3","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#e7298a","#e7298a","#e7298a","#e7298a"]},"nodes":{"name":["C1_MP1","C2_MP1","C3_MP1","C1_MP2","C2_MP2","C3_MP2","C4_MP2"],"group":["#E41A1C","#3E8E93","#7E6E85","#FF7F00","#E1C62F","#DB728C","#999999"]},"options":{"NodeID":"Node","NodeGroup":"color","LinkGroup":"LinkColor","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":22,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#saveNetwork(p1, file = paste0(path,'Subpopulation_Net.html'))</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sessioninfo/man/session_info.html">session_info</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; â”€ Session info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="co">#&gt;  setting  value                       </span>
<span class="co">#&gt;  version  R version 3.6.3 (2020-02-29)</span>
<span class="co">#&gt;  os       macOS Catalina 10.15.5      </span>
<span class="co">#&gt;  system   x86_64, darwin15.6.0        </span>
<span class="co">#&gt;  ui       X11                         </span>
<span class="co">#&gt;  language (EN)                        </span>
<span class="co">#&gt;  collate  en_AU.UTF-8                 </span>
<span class="co">#&gt;  ctype    en_AU.UTF-8                 </span>
<span class="co">#&gt;  tz       Australia/Brisbane          </span>
<span class="co">#&gt;  date     2020-12-16                  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; â”€ Packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="co">#&gt;  package              * version    date       lib</span>
<span class="co">#&gt;  annotate               1.64.0     2019-10-29 [2]</span>
<span class="co">#&gt;  AnnotationDbi        * 1.48.0     2019-10-29 [2]</span>
<span class="co">#&gt;  assertthat             0.2.1      2019-03-21 [2]</span>
<span class="co">#&gt;  backports              1.2.0      2020-11-02 [2]</span>
<span class="co">#&gt;  base64enc              0.1-3      2015-07-28 [2]</span>
<span class="co">#&gt;  Biobase              * 2.46.0     2019-10-29 [2]</span>
<span class="co">#&gt;  BiocGenerics         * 0.32.0     2019-10-29 [2]</span>
<span class="co">#&gt;  BiocManager            1.30.10    2019-11-16 [2]</span>
<span class="co">#&gt;  BiocParallel         * 1.20.1     2019-12-21 [2]</span>
<span class="co">#&gt;  bit                    4.0.4      2020-08-04 [2]</span>
<span class="co">#&gt;  bit64                  4.0.5      2020-08-30 [2]</span>
<span class="co">#&gt;  bitops                 1.0-6      2013-08-17 [2]</span>
<span class="co">#&gt;  blob                   1.2.1      2020-01-20 [2]</span>
<span class="co">#&gt;  callr                  3.5.1      2020-10-13 [2]</span>
<span class="co">#&gt;  caret                * 6.0-86     2020-03-20 [2]</span>
<span class="co">#&gt;  checkmate              2.0.0      2020-02-06 [2]</span>
<span class="co">#&gt;  class                  7.3-15     2019-01-01 [3]</span>
<span class="co">#&gt;  cli                    2.2.0      2020-11-20 [2]</span>
<span class="co">#&gt;  cluster                2.1.0      2019-06-19 [3]</span>
<span class="co">#&gt;  clusterProfiler      * 3.14.3     2020-01-08 [2]</span>
<span class="co">#&gt;  codetools              0.2-16     2018-12-24 [3]</span>
<span class="co">#&gt;  colorspace             2.0-0      2020-11-11 [2]</span>
<span class="co">#&gt;  cowplot                1.1.0      2020-09-08 [2]</span>
<span class="co">#&gt;  crayon                 1.3.4      2017-09-16 [2]</span>
<span class="co">#&gt;  data.table             1.13.2     2020-10-19 [2]</span>
<span class="co">#&gt;  DBI                    1.1.0      2019-12-15 [2]</span>
<span class="co">#&gt;  DelayedArray         * 0.12.3     2020-04-09 [2]</span>
<span class="co">#&gt;  dendextend             1.14.0     2020-08-26 [2]</span>
<span class="co">#&gt;  desc                   1.2.0      2018-05-01 [2]</span>
<span class="co">#&gt;  DESeq2                 1.26.0     2019-10-29 [2]</span>
<span class="co">#&gt;  devtools               2.3.2      2020-09-18 [2]</span>
<span class="co">#&gt;  digest                 0.6.27     2020-10-24 [2]</span>
<span class="co">#&gt;  DO.db                  2.9        2020-11-30 [2]</span>
<span class="co">#&gt;  DOSE                 * 3.12.0     2019-10-29 [2]</span>
<span class="co">#&gt;  dplyr                * 1.0.2      2020-08-18 [2]</span>
<span class="co">#&gt;  dynamicTreeCut       * 1.63-1     2016-03-11 [2]</span>
<span class="co">#&gt;  e1071                  1.7-4      2020-10-14 [2]</span>
<span class="co">#&gt;  ellipsis               0.3.1      2020-05-15 [2]</span>
<span class="co">#&gt;  enrichplot             1.6.1      2019-12-16 [2]</span>
<span class="co">#&gt;  europepmc              0.4        2020-05-31 [2]</span>
<span class="co">#&gt;  evaluate               0.14       2019-05-28 [2]</span>
<span class="co">#&gt;  fansi                  0.4.1      2020-01-08 [2]</span>
<span class="co">#&gt;  farver                 2.0.3      2020-01-16 [2]</span>
<span class="co">#&gt;  fastcluster            1.1.25     2018-06-07 [2]</span>
<span class="co">#&gt;  fastmatch              1.1-0      2017-01-28 [2]</span>
<span class="co">#&gt;  fgsea                  1.12.0     2019-10-29 [2]</span>
<span class="co">#&gt;  foreach                1.5.1      2020-10-15 [2]</span>
<span class="co">#&gt;  foreign                0.8-75     2020-01-20 [3]</span>
<span class="co">#&gt;  Formula                1.2-4      2020-10-16 [2]</span>
<span class="co">#&gt;  fs                     1.5.0      2020-07-31 [2]</span>
<span class="co">#&gt;  genefilter             1.68.0     2019-10-29 [2]</span>
<span class="co">#&gt;  geneplotter            1.64.0     2019-10-29 [2]</span>
<span class="co">#&gt;  generics               0.1.0      2020-10-31 [2]</span>
<span class="co">#&gt;  GenomeInfoDb         * 1.22.1     2020-03-27 [2]</span>
<span class="co">#&gt;  GenomeInfoDbData       1.2.2      2020-11-30 [2]</span>
<span class="co">#&gt;  GenomicRanges        * 1.38.0     2019-10-29 [2]</span>
<span class="co">#&gt;  ggforce                0.3.2      2020-06-23 [2]</span>
<span class="co">#&gt;  ggplot2              * 3.3.2      2020-06-19 [2]</span>
<span class="co">#&gt;  ggplotify              0.0.5      2020-03-12 [2]</span>
<span class="co">#&gt;  ggraph                 2.0.4      2020-11-16 [2]</span>
<span class="co">#&gt;  ggrepel                0.8.2      2020-03-08 [2]</span>
<span class="co">#&gt;  ggridges               0.5.2      2020-01-12 [2]</span>
<span class="co">#&gt;  glmnet                 4.0-2      2020-06-16 [2]</span>
<span class="co">#&gt;  glue                   1.4.2      2020-08-27 [2]</span>
<span class="co">#&gt;  GO.db                  3.10.0     2020-11-30 [2]</span>
<span class="co">#&gt;  GOSemSim               2.12.1     2020-03-19 [2]</span>
<span class="co">#&gt;  gower                  0.2.2      2020-06-23 [2]</span>
<span class="co">#&gt;  graph                  1.64.0     2019-10-29 [2]</span>
<span class="co">#&gt;  graphite               1.32.0     2019-10-29 [2]</span>
<span class="co">#&gt;  graphlayouts           0.7.1      2020-10-26 [2]</span>
<span class="co">#&gt;  gridExtra              2.3        2017-09-09 [2]</span>
<span class="co">#&gt;  gridGraphics           0.5-0      2020-02-25 [2]</span>
<span class="co">#&gt;  gtable                 0.3.0      2019-03-25 [2]</span>
<span class="co">#&gt;  Hmisc                  4.4-2      2020-11-29 [2]</span>
<span class="co">#&gt;  hms                    0.5.3      2020-01-08 [2]</span>
<span class="co">#&gt;  htmlTable              2.1.0      2020-09-16 [2]</span>
<span class="co">#&gt;  htmltools              0.5.0      2020-06-16 [2]</span>
<span class="co">#&gt;  htmlwidgets            1.5.2      2020-10-03 [2]</span>
<span class="co">#&gt;  httr                   1.4.2      2020-07-20 [2]</span>
<span class="co">#&gt;  igraph                 1.2.6      2020-10-06 [2]</span>
<span class="co">#&gt;  ipred                  0.9-9      2019-04-28 [2]</span>
<span class="co">#&gt;  IRanges              * 2.20.2     2020-01-13 [2]</span>
<span class="co">#&gt;  iterators              1.0.13     2020-10-15 [2]</span>
<span class="co">#&gt;  jpeg                   0.1-8.1    2019-10-24 [2]</span>
<span class="co">#&gt;  jsonlite               1.7.1      2020-09-07 [2]</span>
<span class="co">#&gt;  knitr                  1.30       2020-09-22 [2]</span>
<span class="co">#&gt;  labeling               0.4.2      2020-10-20 [2]</span>
<span class="co">#&gt;  lattice              * 0.20-38    2018-11-04 [3]</span>
<span class="co">#&gt;  latticeExtra           0.6-29     2019-12-19 [2]</span>
<span class="co">#&gt;  lava                   1.6.8.1    2020-11-04 [2]</span>
<span class="co">#&gt;  lifecycle              0.2.0      2020-03-06 [2]</span>
<span class="co">#&gt;  locfit               * 1.5-9.4    2020-03-25 [2]</span>
<span class="co">#&gt;  lubridate              1.7.9.2    2020-11-13 [2]</span>
<span class="co">#&gt;  magrittr               2.0.1      2020-11-17 [2]</span>
<span class="co">#&gt;  MASS                   7.3-51.5   2019-12-20 [3]</span>
<span class="co">#&gt;  Matrix                 1.2-18     2019-11-27 [3]</span>
<span class="co">#&gt;  matrixStats          * 0.57.0     2020-09-25 [2]</span>
<span class="co">#&gt;  memoise                1.1.0      2017-04-21 [2]</span>
<span class="co">#&gt;  ModelMetrics           1.2.2.2    2020-03-17 [2]</span>
<span class="co">#&gt;  munsell                0.5.0      2018-06-12 [2]</span>
<span class="co">#&gt;  networkD3            * 0.4        2017-03-18 [2]</span>
<span class="co">#&gt;  nlme                   3.1-144    2020-02-06 [3]</span>
<span class="co">#&gt;  nnet                   7.3-12     2016-02-02 [3]</span>
<span class="co">#&gt;  org.Hs.eg.db         * 3.10.0     2020-11-30 [2]</span>
<span class="co">#&gt;  pillar                 1.4.7      2020-11-20 [2]</span>
<span class="co">#&gt;  pkgbuild               1.1.0      2020-07-13 [2]</span>
<span class="co">#&gt;  pkgconfig              2.0.3      2019-09-22 [2]</span>
<span class="co">#&gt;  pkgdown                1.6.1.9000 2020-12-14 [2]</span>
<span class="co">#&gt;  pkgload                1.1.0      2020-05-29 [2]</span>
<span class="co">#&gt;  plyr                   1.8.6      2020-03-03 [2]</span>
<span class="co">#&gt;  png                    0.1-7      2013-12-03 [2]</span>
<span class="co">#&gt;  polyclip               1.10-0     2019-03-14 [2]</span>
<span class="co">#&gt;  prettyunits            1.1.1      2020-01-24 [2]</span>
<span class="co">#&gt;  pROC                   1.16.2     2020-03-19 [2]</span>
<span class="co">#&gt;  processx               3.4.4      2020-09-03 [2]</span>
<span class="co">#&gt;  prodlim                2019.11.13 2019-11-17 [2]</span>
<span class="co">#&gt;  progress               1.2.2      2019-05-16 [2]</span>
<span class="co">#&gt;  ps                     1.4.0      2020-10-07 [2]</span>
<span class="co">#&gt;  purrr                  0.3.4      2020-04-17 [2]</span>
<span class="co">#&gt;  qvalue                 2.18.0     2019-10-29 [2]</span>
<span class="co">#&gt;  R6                     2.5.0      2020-10-28 [2]</span>
<span class="co">#&gt;  ragg                   0.4.0      2020-10-05 [2]</span>
<span class="co">#&gt;  rappdirs               0.3.1      2016-03-28 [2]</span>
<span class="co">#&gt;  RColorBrewer           1.1-2      2014-12-07 [2]</span>
<span class="co">#&gt;  Rcpp                   1.0.5      2020-07-06 [2]</span>
<span class="co">#&gt;  RcppArmadillo          0.10.1.2.0 2020-11-16 [2]</span>
<span class="co">#&gt;  RcppParallel           5.0.2      2020-06-24 [2]</span>
<span class="co">#&gt;  RCurl                  1.98-1.2   2020-04-18 [2]</span>
<span class="co">#&gt;  reactome.db            1.70.0     2020-11-30 [2]</span>
<span class="co">#&gt;  ReactomePA           * 1.30.0     2019-10-29 [2]</span>
<span class="co">#&gt;  recipes                0.1.15     2020-11-11 [2]</span>
<span class="co">#&gt;  remotes                2.2.0      2020-07-21 [2]</span>
<span class="co">#&gt;  reshape2               1.4.4      2020-04-09 [2]</span>
<span class="co">#&gt;  rlang                  0.4.9      2020-11-26 [2]</span>
<span class="co">#&gt;  rmarkdown              2.5        2020-10-21 [2]</span>
<span class="co">#&gt;  rpart                  4.1-15     2019-04-12 [3]</span>
<span class="co">#&gt;  rprojroot              2.0.2      2020-11-15 [2]</span>
<span class="co">#&gt;  RSQLite                2.2.1      2020-09-30 [2]</span>
<span class="co">#&gt;  rstudioapi             0.13       2020-11-12 [2]</span>
<span class="co">#&gt;  Rtsne                  0.15       2018-11-10 [2]</span>
<span class="co">#&gt;  rvcheck                0.1.8      2020-03-01 [2]</span>
<span class="co">#&gt;  S4Vectors            * 0.24.4     2020-04-09 [2]</span>
<span class="co">#&gt;  scales                 1.1.1      2020-05-11 [2]</span>
<span class="co">#&gt;  scGPS                * 1.5.1      2020-12-16 [1]</span>
<span class="co">#&gt;  sessioninfo            1.1.1      2018-11-05 [2]</span>
<span class="co">#&gt;  shape                  1.4.5      2020-09-13 [2]</span>
<span class="co">#&gt;  SingleCellExperiment * 1.8.0      2019-10-29 [2]</span>
<span class="co">#&gt;  stringi                1.5.3      2020-09-09 [2]</span>
<span class="co">#&gt;  stringr                1.4.0      2019-02-10 [2]</span>
<span class="co">#&gt;  SummarizedExperiment * 1.16.1     2019-12-19 [2]</span>
<span class="co">#&gt;  survival               3.1-8      2019-12-03 [3]</span>
<span class="co">#&gt;  systemfonts            0.3.2      2020-09-29 [2]</span>
<span class="co">#&gt;  testthat               3.0.0      2020-10-31 [2]</span>
<span class="co">#&gt;  textshaping            0.2.1      2020-11-13 [2]</span>
<span class="co">#&gt;  tibble                 3.0.4      2020-10-12 [2]</span>
<span class="co">#&gt;  tidygraph              1.2.0      2020-05-12 [2]</span>
<span class="co">#&gt;  tidyr                  1.1.2      2020-08-27 [2]</span>
<span class="co">#&gt;  tidyselect             1.1.0      2020-05-11 [2]</span>
<span class="co">#&gt;  timeDate               3043.102   2018-02-21 [2]</span>
<span class="co">#&gt;  triebeard              0.3.0      2016-08-04 [2]</span>
<span class="co">#&gt;  tweenr                 1.0.1      2018-12-14 [2]</span>
<span class="co">#&gt;  urltools               1.7.3      2019-04-14 [2]</span>
<span class="co">#&gt;  usethis                1.6.3      2020-09-17 [2]</span>
<span class="co">#&gt;  vctrs                  0.3.5      2020-11-17 [2]</span>
<span class="co">#&gt;  viridis                0.5.1      2018-03-29 [2]</span>
<span class="co">#&gt;  viridisLite            0.3.0      2018-02-01 [2]</span>
<span class="co">#&gt;  withr                  2.3.0      2020-09-22 [2]</span>
<span class="co">#&gt;  xfun                   0.19       2020-10-30 [2]</span>
<span class="co">#&gt;  XML                    3.99-0.3   2020-01-20 [2]</span>
<span class="co">#&gt;  xml2                   1.3.2      2020-04-23 [2]</span>
<span class="co">#&gt;  xtable                 1.8-4      2019-04-21 [2]</span>
<span class="co">#&gt;  XVector                0.26.0     2019-10-29 [2]</span>
<span class="co">#&gt;  yaml                   2.2.1      2020-02-01 [2]</span>
<span class="co">#&gt;  zlibbioc               1.32.0     2019-10-29 [2]</span>
<span class="co">#&gt;  source                        </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.3)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.3)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.3)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.3)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.3)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.3)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.3)                </span>
<span class="co">#&gt;  CRAN (R 3.6.3)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.3)                </span>
<span class="co">#&gt;  CRAN (R 3.6.3)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  Github (r-lib/pkgdown@6094ac3)</span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.3)                </span>
<span class="co">#&gt;  CRAN (R 3.6.3)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.3)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  CRAN (R 3.6.2)                </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt;  CRAN (R 3.6.0)                </span>
<span class="co">#&gt;  Bioconductor                  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [1] /private/var/folders/ly/hvwnyg4x6f555q7szp3grcfh0000gr/T/Rtmp5g0gPX/temp_libpath36067156566d</span>
<span class="co">#&gt; [2] /Users/uqmtho32/Library/R/3.6/library</span>
<span class="co">#&gt; [3] /Library/Frameworks/R.framework/Versions/3.6/Resources/library</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Quan Nguyen, Michael Thompson, Anne Senabouth.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
